<!DOCTYPE html>
<html lang="en">
	<head>
	    <meta charset="utf-8">
	    <meta name="viewport" content="width=device-width, initial-scale=1">
	    <meta name="description" content=" AI organizations around the world ">
	    <meta name="author" content=" t-y-l-e-r ">
	    <title>Ai Landscape</title>
	    <!--CSS FILE-->
    	<link rel="stylesheet" href="css/response.css">
	</head>
	<body>
		<main class="container">
			<!--THE HAMBURGER BAR-->
			<div class="navcontainer">
				<div class="row">
					<div class="menu-icon">
						<img src="img/ham.svg" alt="menu icon">
					</div>
					<div class="title">
						<h4>Ai Landscape</h4>
					</div>
				</div>
			<!--THE LOCATION LIST / HIDDEN MENU-->
				<div class="row">
					<nav id="drawer" class="nav">
	      				<ul style="list-style: none">
	      					<li>
	      						<select data-bind="options: tagList, optionsText: 'tag', value: selectedTag"></select>
	      					</li>
	      				</ul>
	      				<ul class="nav__list" data-bind="foreach: displayItems" style="list-style: none">
					       	<li class="nav-item org" data-bind="text: name, visible: visibleProp, click: $root.clickOrg"></li>
				    	</ul>
				 	</nav>
				</div>
			</div>
			<!--THE MAP-->
			<div class="row">
				<div id="map"></div>
			</div>
			<!--API ATTRIBUTION
			<div class="row">
				<div id="attributions"><p><a href=" https://newsapi.org">Powered by News API</a></p></div>
			</div>-->
		</main>
		<footer>
			<!--JS DOCS-->
			<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  			<script src="https://ajax.aspnetcdn.com/ajax/knockout/knockout-3.4.2.js"></script>
    		<script src="js/app.js"></script>
    		<!--GOOGLE MAP-->
			<script>
				//Variables used to manage marker icons
			    var prim = "http://maps.google.com/mapfiles/ms/icons/red-dot.png";
				//star icon and programming not implemented in this iteration, was used for comprehensive click testing
				var star = "http://maps.google.com/mapfiles/ms/icons/yellow-dot.png";
				var select = "http://maps.google.com/mapfiles/ms/icons/blue-dot.png";
				var markers = [];
				var premarkerid = -1;
				var premarker, marker, latlong;
				var markerClicks;
				//The next 298 lines of code creates a map, and sets the intial settings and styles. 
				function initMap() {
			        var uluru = {lat: 0, lng: -122};
			        var map = new google.maps.Map(document.getElementById('map'), {
			          zoom: 2.5,
			          center: uluru,
			          mapTypeControl: false,
			          streetViewControl: false,
			          fullscreenControl: false,
			          styles: [
						  {
						    "elementType": "geometry",
						    "stylers": [
						      {
						        "color": "#ebe3cd"
						      }
						    ]
						  },
						  {
						    "elementType": "labels",
						    "stylers": [
						      {
						        "visibility": "off"
						      }
						    ]
						  },
						  {
						    "elementType": "labels.text.fill",
						    "stylers": [
						      {
						        "color": "#523735"
						      }
						    ]
						  },
						  {
						    "elementType": "labels.text.stroke",
						    "stylers": [
						      {
						        "color": "#f5f1e6"
						      }
						    ]
						  },
						  {
						    "featureType": "administrative",
						    "elementType": "geometry.stroke",
						    "stylers": [
						      {
						        "color": "#c9b2a6"
						      }
						    ]
						  },
						  {
						    "featureType": "administrative.country",
						    "elementType": "geometry.fill",
						    "stylers": [
						      {
						        "visibility": "off"
						      }
						    ]
						  },
						  {
						    "featureType": "administrative.land_parcel",
						    "stylers": [
						      {
						        "visibility": "off"
						      }
						    ]
						  },
						  {
						    "featureType": "administrative.land_parcel",
						    "elementType": "geometry.stroke",
						    "stylers": [
						      {
						        "color": "#dcd2be"
						      }
						    ]
						  },
						  {
						    "featureType": "administrative.land_parcel",
						    "elementType": "labels.text.fill",
						    "stylers": [
						      {
						        "color": "#ae9e90"
						      }
						    ]
						  },
						  {
						    "featureType": "administrative.neighborhood",
						    "stylers": [
						      {
						        "visibility": "off"
						      }
						    ]
						  },
						  {
						    "featureType": "landscape.natural",
						    "elementType": "geometry",
						    "stylers": [
						      {
						        "color": "#dfd2ae"
						      }
						    ]
						  },
						  {
						    "featureType": "poi",
						    "elementType": "geometry",
						    "stylers": [
						      {
						        "color": "#dfd2ae"
						      }
						    ]
						  },
						  {
						    "featureType": "poi",
						    "elementType": "labels.text",
						    "stylers": [
						      {
						        "visibility": "off"
						      }
						    ]
						  },
						  {
						    "featureType": "poi",
						    "elementType": "labels.text.fill",
						    "stylers": [
						      {
						        "color": "#93817c"
						      }
						    ]
						  },
						  {
						    "featureType": "poi.business",
						    "stylers": [
						      {
						        "visibility": "off"
						      }
						    ]
						  },
						  {
						    "featureType": "poi.park",
						    "elementType": "geometry.fill",
						    "stylers": [
						      {
						        "color": "#a5b076"
						      }
						    ]
						  },
						  {
						    "featureType": "poi.park",
						    "elementType": "labels.text.fill",
						    "stylers": [
						      {
						        "color": "#447530"
						      }
						    ]
						  },
						  {
						    "featureType": "road",
						    "stylers": [
						      {
						        "visibility": "off"
						      }
						    ]
						  },
						  {
						    "featureType": "road",
						    "elementType": "geometry",
						    "stylers": [
						      {
						        "color": "#f5f1e6"
						      }
						    ]
						  },
						  {
						    "featureType": "road",
						    "elementType": "labels.icon",
						    "stylers": [
						      {
						        "visibility": "off"
						      }
						    ]
						  },
						  {
						    "featureType": "road.arterial",
						    "elementType": "geometry",
						    "stylers": [
						      {
						        "color": "#fdfcf8"
						      }
						    ]
						  },
						  {
						    "featureType": "road.highway",
						    "elementType": "geometry",
						    "stylers": [
						      {
						        "color": "#f8c967"
						      }
						    ]
						  },
						  {
						    "featureType": "road.highway",
						    "elementType": "geometry.stroke",
						    "stylers": [
						      {
						        "color": "#e9bc62"
						      }
						    ]
						  },
						  {
						    "featureType": "road.highway.controlled_access",
						    "elementType": "geometry",
						    "stylers": [
						      {
						        "color": "#e98d58"
						      }
						    ]
						  },
						  {
						    "featureType": "road.highway.controlled_access",
						    "elementType": "geometry.stroke",
						    "stylers": [
						      {
						        "color": "#db8555"
						      }
						    ]
						  },
						  {
						    "featureType": "road.local",
						    "elementType": "labels.text.fill",
						    "stylers": [
						      {
						        "color": "#806b63"
						      }
						    ]
						  },
						  {
						    "featureType": "transit",
						    "stylers": [
						      {
						        "visibility": "off"
						      }
						    ]
						  },
						  {
						    "featureType": "transit.line",
						    "elementType": "geometry",
						    "stylers": [
						      {
						        "color": "#dfd2ae"
						      }
						    ]
						  },
						  {
						    "featureType": "transit.line",
						    "elementType": "labels.text.fill",
						    "stylers": [
						      {
						        "color": "#8f7d77"
						      }
						    ]
						  },
						  {
						    "featureType": "transit.line",
						    "elementType": "labels.text.stroke",
						    "stylers": [
						      {
						        "color": "#ebe3cd"
						      }
						    ]
						  },
						  {
						    "featureType": "transit.station",
						    "elementType": "geometry",
						    "stylers": [
						      {
						        "color": "#dfd2ae"
						      }
						    ]
						  },
						  {
						    "featureType": "water",
						    "elementType": "geometry.fill",
						    "stylers": [
						      {
						        "color": "#b9d3c2"
						      }
						    ]
						  },
						  {
						    "featureType": "water",
						    "elementType": "labels.text.fill",
						    "stylers": [
						      {
						        "color": "#92998d"
						      }
						    ]
						  }
						]
			        });
					var infowindow = new google.maps.InfoWindow({
						content: '<div id="content">'+'<div id="siteNotice">'+'</div>'+
						            '<h1 id="firstHeading" class="firstHeading">Uluru</h1>'+
						            '<div id="bodyContent">'+
						            '<p><b>Uluru</b>, also referred to as <b>Ayers Rock</b>, is a large ' +
						            'sandstone rock formation in the southern part of the '+
						            'Northern Territory, central Australia. It lies 335&#160;km (208&#160;mi) '+
						            'south west of the nearest large town, Alice Springs; 450&#160;km '+
						            '(280&#160;mi) by road. Kata Tjuta and Uluru are the two major '+
						            'features of the Uluru - Kata Tjuta National Park. Uluru is '+
						            'sacred to the Pitjantjatjara and Yankunytjatjara, the '+
						            'Aboriginal people of the area. It has many springs, waterholes, '+
						            'rock caves and ancient paintings. Uluru is listed as a World '+
						            'Heritage Site.</p>'+
						            '<p>Attribution: Uluru, <a href="https://en.wikipedia.org/w/index.php?title=Uluru&oldid=297882194">'+
						            'https://en.wikipedia.org/w/index.php?title=Uluru</a> '+
						            '(last visited June 22, 2009).</p>'+
						            '</div>'+
						            '</div>'
					});
			       //Populates map with Markers by looping through the model data found in app.js
			        for(i = 0; i < model.length; i++){
			        	latlong = {lat: (model[i].latlong[0]), lng: (model[i].latlong[1])};
			        	marker = (new google.maps.Marker({
				          id: i,
				          position: latlong,
				          map: map,
				          title: model[i].name,
				          star: model[i].priority,
				          icon: prim,
				          content: model[i].content,
				          news: model[i].news
			        	}));
			        	markers.push(marker);
			        	if(premarker === undefined || premarker == null || premarker.length <= 0) {
			        		premarker = markers[i];
			        	}
			        				    	//handles marker clicks in various orders - sets icons, opens info windows, selects list items
				      	markerClicks = google.maps.event.addListener(marker, 'click', (function(marker) {
	        				return function() {
	        						//different marker is clicked
									if (marker.id != premarkerid){
										markers[marker.id].setIcon(select);
										infowindow.open(map, markers[marker.id]);
										//reset previously clicked marker to proper icon
										if (premarker.star) {
											premarker.setIcon(star);	
										}
										else{
											premarker.setIcon(prim);
										}
									}
									//repetitive clicks on same marker
									else {
										//marker receives third consecutive click
										if(markers[marker.id].icon != select) {
											markers[marker.id].setIcon(select);
											infowindow.open(map, markers[marker.id]);
										}
										//marker receives second consecutive click
										else {
											//reset marker to proper icon
											if (markers[marker.id].star) {
												markers[marker.id].setIcon(star);
											}
											else{
												markers[marker.id].setIcon(prim);
											}
										infowindow.close();
										}	
									}
									//sets marker to be previously clicked marker for next click event
									premarkerid = marker.id;
									premarker = markers[marker.id];
							}
						})(marker));				
			    	};
			      }
			    </script>
			    <script async defer
			    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCz-exyRW9FYmIXb8bNKrwHDFSVOrswqsE&callback=initMap">
			    </script>
			    <script>ko.applyBindings(new myViewModel());</script>
		</footer>
	</body>
</html>